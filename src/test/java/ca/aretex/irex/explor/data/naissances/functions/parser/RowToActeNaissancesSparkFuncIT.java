package ca.aretex.irex.explor.data.naissances.functions.parser;

import ca.aretex.irex.explor.data.naissances.beans.ActeNaissances;
import org.junit.jupiter.api.Test;

import static org.assertj.core.api.Assertions.assertThat;

public class RowToActeNaissancesSparkFuncIT {

    @Test
    public void testCall() {
        RowToActenaissancesSparkFunc f = new RowToActenaissancesSparkFunc();
        String line = "\"Sixt-sur-Aff\",\"35328\",\"Naisssance\",\"0\",\"JANVIER\",\"2020\"";
        ActeNaissances expected = ActeNaissances.builder()
                .nombre("0").mois("JANVIER").annee("2020")
                .build();

        ActeNaissances actual = f.call(line);

        assertThat(actual).isEqualTo(expected);
    }
}
