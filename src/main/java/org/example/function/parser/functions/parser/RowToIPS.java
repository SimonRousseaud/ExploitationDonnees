package org.example.function.parser.functions.parser;


import org.apache.spark.sql.Row;
import org.example.function.parser.beans.IPS;

import java.io.Serializable;
import java.util.function.Function;

public class RowToIPS implements Function<Row, IPS>, Serializable {

    @Override
    public IPS apply(Row row) {

        String Date = row.getAs("rentree_scolaire");
        String Academy = row.getAs("academie");
        String CodeDep = row.getAs("code_du_departement");
        String Dep = row.getAs("departement");
        String Uai = row.getAs("uai");
        String SchoolName = row.getAs("nom_de_l_etablissment");
        String InseeCode = row.getAs("code_insee_de_la_commune");
        String Town = row.getAs("nom_de_la_commune");
        String Sector = row.getAs("secteur");
        String Ips = row.getAs("ips");

        return IPS.builder()
                .Date(Date)
                .Academy(Academy)
                .CodeDep(CodeDep)
                .Dep(Dep)
                .Uai(Uai)
                .SchoolName(SchoolName)
                .InseeCode(InseeCode)
                .Town(Town)
                .Sector(Sector)
                .Ips(Ips)
                .build();
    }
}
