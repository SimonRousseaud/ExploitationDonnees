package ca.aretex.irex.explor.data.naissances.functions.parser;


import ca.aretex.irex.explor.data.naissances.beans.ActeNaissances;
import lombok.extern.slf4j.Slf4j;
import org.apache.commons.lang3.StringUtils;
import org.apache.spark.api.java.function.MapFunction;

@Slf4j
public class RowToActenaissancesSparkFunc implements MapFunction<String, ActeNaissances> {

    @Override
    public ActeNaissances call(String line) {
        log.info("current line = {}", line);

        String[] Str = StringUtils.splitByWholeSeparatorPreserveAllTokens(line, ",", 100);

        String nombre = Str[3].trim();
        String mois = Str[4].trim();
        String annee = Str[5].trim();

        return ActeNaissances.builder()
                .nombre(nombre)
                .mois(mois)
                .annee(annee)
                .build();
    }
}
