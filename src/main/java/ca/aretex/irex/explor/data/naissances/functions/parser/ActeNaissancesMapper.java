package ca.aretex.irex.explor.data.naissances.functions.parser;

import ca.aretex.irex.explor.data.naissances.beans.ActeNaissances;
import org.apache.spark.sql.Dataset;
import org.apache.spark.sql.Encoders;

import java.util.function.Function;

public class ActeNaissancesMapper implements Function<Dataset<String>, Dataset<ActeNaissances>>  {
//    private final RowToActenaissancesFunc parser = new RowToActenaissancesFunc();
//    private final MapFunction<Row, Actenaissances> task = parser::apply;
//    private final MapFunction<Row, Actenaissances> task = r -> parser.apply(r);
//    private final MapFunction<Row, Actenaissances> task = new MapFunction<Row, Actenaissances>() {
//        @Override
//        public Actenaissances call(Row r) throws Exception {
//            return parser.apply(r);
//        }
//    };

    private final RowToActenaissancesSparkFunc task = new RowToActenaissancesSparkFunc();


    @Override
    public Dataset<ActeNaissances> apply(Dataset<String> inputDS) {
        return inputDS.map(task, Encoders.bean(ActeNaissances.class));
    }
}
